<!DOCTYPE html>

<head>
    {{@includes/head.niml}}
    <link type="text/css" rel="stylesheet" href="http://interblocks.nidn.yangram.ni/src/see/Slider/style.css">
    <link type="text/css" rel="stylesheet" href="{{$__SRCDIR}}stylesheets/homepage.css">
</head>

<body>
    {{@includes/header.niml}}
    <div class="container">
        {{.label('ad_slider1')}}
        <section class="news ic h390 grid-12">
            <div class="ic hfull nm-8">
                <div class="newslist ic stabs" data-ic-auto="true">
                    <h3>学院要闻</h3>
                    <json name="$fields"> ["dev_figure", "dev_abstract"] </json>
                    <def name="$newslist" onload="CM.SPC.getList" args="'news', 15, CM.SPCLite.PUBLISHED, CM.SPCLite.PUBTIME_DESC, 0, 9, Model::LIST_AS_OBJ, $fields" />
                    <ul class="news-figures">
                        <for $item of $newslist>
                            <li class="nf-item tab-section">
                                <figure>
                                    <a href="{{$REQUEST.DIR}}s/news/article/{{***$item.ID***}}/" target="_blank"><img src="{{$item.dev_figure}}"></a>
                                    <figcaption>
                                        <h5 class="news-title">
                                            <a href="{{$REQUEST.DIR}}s/news/article/{{***$item.ID***}}/" target="_blank">
                                                <str value="$item.TITLE" length="22" />
                                            </a>
                                        </h5>
                                        <p class="news-desc">
                                            <str value="$item.dev_abstract" length="100" use-ellipsis />
                                        </p>
                                    </figcaption>
                                </figure>
                            </li>
                        </for>
                    </ul>
                    <ul class="news-metainfs">
                        <for $item of $newslist>
                            <li data-tab-index="{{$index}}" class="nm-item tab-anchor actived">
                                <a href="{{$REQUEST.DIR}}s/news/article/{{***$item.ID***}}/" target="_blank">
                                    <str value="$item.TITLE" length="22" />
                                </a>
                            </li>
                            </li>
                        </for>
                    </ul>
                </div>
            </div>
            <div class="nm-4 ">
                <div class="notices">
                    <h3>通知公告</h3>
                    <def name="$annclist" onload="CM.SPC.getList" args="'announcements', NULL, CM.SPCLite.PUBLISHED, CM.SPCLite.PUBTIME_DESC, 0, 6, Model::LIST_AS_OBJ" />
                    <ul class="notice-cards">
                        <for $item of $annclist>
                            <li class="notice-card">
                                <p class="notice-time"><time value="$item.PUBTIME" format="Y-m-d" /></p>
                                <p class="notice-message">
                                    <a href="{{$REQUEST.DIR}}s/announcements/article/{{***$item.ID***}}/" target="_blank">
                                        <str value="$item.TITLE" length="22" />
                                    </a>
                                </p>
                            </li>
                        </for>
                    </ul>
                    <p class="see-more"><a href="" target="_blank">更多&gt;&gt;</a></p>
                </div>
            </div>
        </section>
        {{.label(2)}}
        <section class="articles ic h310 grid-12">
            <script id="newstp" type="text/template">
                <li><a href="{@url}" target="_blank">{@title}</a></li>
            </script>
            <div class="nm-4">
                <div class="artilisttabs ic w380 h260 ma-25 tabs" data-ic-auto="true" data-tabs-trigger="mouseover" data-tabs-keyclass="actived">
                    <header class="tabanchors">
                        <span class="tab-anchor actived" data-tab-index="0" data-src="">校园时讯</span>
                        <span class="tab-anchor" data-tab-index="1" data-src="">媒体建筑</span>
                        <i class="see-more"></i>
                    </header>
                    <ul class="xysx tab-section actived">

                    </ul>
                    <ul class="jzmt tab-section">

                    </ul>
                </div>
            </div>
            <div class="nm-4">
                <div class="artilisttabs ic w380 h260 ma-25 tabs" data-ic-auto="true" data-tabs-trigger="mouseover" data-tabs-keyclass="actived">
                    <header class="tabanchors">
                        <span class="tab-anchor actived" data-tab-index="0" data-src="">创新创业</span>
                        <span class="tab-anchor" data-tab-index="1" data-src="">转型发展</span>
                        <i class="see-more"></i>
                    </header>
                    <ul class="cxcy tab-section actived">

                    </ul>
                    <ul class="zxfz tab-section">

                    </ul>
                </div>
            </div>
            <div class="nm-4">
                <div class="artilisttabs ic w380 h260 ma-25 tabs" data-ic-auto="true" data-tabs-trigger="mouseover" data-tabs-keyclass="actived">
                    <header class="tabanchors">
                        <span class="tab-anchor actived" data-tab-index="0" data-src="">就业信息</span>
                        <span class="tab-anchor" data-tab-index="1" data-src="">校友之家</span>
                        <i class="see-more"></i>
                    </header>
                    <ul class="jyxx tab-section actived">

                    </ul>
                    <ul class="xyzj tab-section">

                    </ul>
                </div>
            </div>
        </section>
        <section class="photos">
            <header class="photos-title">
                <h3 class="">建筑印象 SCENERY</h3><a href="" class="more-photos">更多&gt;&gt;</a></header>
            <def name="$photos" onload="CM.SPC.getList" args="'photos', NULL, CM.SPCLite.PUBLISHED, CM.SPCLite.CTIME_DESC, 0, 5, Model::LIST_AS_OBJ" />
            <ul class="newfive">
                <for $item of $photos>
                    <li>
                        <figure>
                            <a href="{{$REQUEST.DIR}}s/photos/article/{{***$item.ID***}}/" target="_blank"><img src="{{$item.dev_thumb}}"></a>
                            <figcaption>
                                <a href="{{$REQUEST.DIR}}s/photos/article/{{***$item.ID***}}/" target="_blank">
                                    <str value="$item.TITLE" length="18" use-ellipsis />
                                </a>
                            </figcaption>
                        </figure>
                    </li>
                </for>
            </ul>
        </section>
    </div>
    {{@includes/footer.niml}}
    <script type="text/javascript">
        var includes = [
            '$_/data/',
            '$_/data/Base64.Cls',
            '$_/dom/Elements/',
            '$_/dom/Template.Cls',
            '$_/see/Slider/',
            '$_/see/Slider/colx3.opts',
            '$_/see/Slider/slide-vert.opts'
        ];
        iBlock(includes, function(_, global, undefined) {
            var document = global.document;
            var location = global.location;
            var $ = _.dom.select;

            $('#myslide').each(function(index, element) {
                new _.see.Slider(this, 'colx3', {
                    kbCtrlAble: true
                });
            });

            $('.banners').each(function(index, element) {
                new _.see.Slider(this, 'slide-vert', {
                    kbCtrlAble: false
                });
            });

            $('.artilisttabs .see-more').click(function() {
                //alert('You triggered a see-more button');
                var url = $('.tab-anchor.actived', this.parentNode).data('src');
                if (url) {
                    global.open(url, '_blank');
                }
            });



            var newscats = {
                    xysx: {
                        set_alias: 'news',
                        url: '{{$REQUEST.DIR}}o/contents/spc/get_list_by_cat/16/2/0/6/'
                    },
                    jzmt: {
                        set_alias: 'news',
                        url: '{{$REQUEST.DIR}}o/contents/spc/get_list_by_cat/20/2/0/6/'
                    },
                    cxcy: {
                        set_alias: 'chuangs',
                        url: '{{$REQUEST.DIR}}o/contents/spc/get_list_by_preset/chuangs/2/0/6/'
                    },
                    zxfz: {
                        set_alias: 'fazhans',
                        url: '{{$REQUEST.DIR}}o/contents/spc/get_list_by_preset/fazhans/2/0/6/'
                    },
                    jyxx: {
                        set_alias: 'jiuyes',
                        url: '{{$REQUEST.DIR}}o/contents/spc/get_list_by_preset/jiuyes/2/0/6/'
                    },
                    xyzj: {
                        set_alias: 'stunews',
                        url: '{{$REQUEST.DIR}}o/contents/spc/get_list_by_preset/stunews/2/0/6/'
                    }
                },
                coder = new _.data.Base64(),
                template = new _.dom.Template($('#newstp').html());

            _.each(newscats, function(cat, meta) {
                _.data.json(meta.url, function(data) {
                    template.clear();
                    _.each(data, function(i, news) {
                        template.complie({
                            url: '{{$REQUEST.DIR}}s/' + news.SET_ALIAS + '/article/' + coder.encode(news.ID),
                            title: news.TITLE
                        });
                    });
                    template.echo(), $('.artilisttabs .tab-section.' + cat).html(template.echo());
                }, function() {
                    console.log(cat + '加载失败');
                })
            });
        }, true);
    </script>
</body>

</html>